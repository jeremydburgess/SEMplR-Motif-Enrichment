% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichmentSets.R
\name{enrichmentSets}
\alias{enrichmentSets}
\title{Run the Full Differential‐Expression Motif Enrichment Pipeline}
\usage{
enrichmentSets(
  foreground_ids,
  background_ids = NULL,
  id_type = "auto",
  organism = "Homo sapiens",
  genomeBuild = "auto",
  txdb = "auto",
  getEnsDb = FALSE,
  transcript = FALSE,
  threshold = 0.9,
  stripVersions = TRUE,
  inflateThresh = 1,
  geneType = NULL,
  ensdb = NULL,
  TSS.method = c("UCSCgene", "Ensembl_canonical", "commonTSS", "uniqueTSS",
    "fivePrimeTSS", "allTSS"),
  overlapMinGap = 0,
  onePromoterPerGene = FALSE,
  bgMethod = c("matched", "pool", "random"),
  n_ratio = 1,
  bgExcludeFgOverlaps = TRUE,
  bgExcludeFgGenes = FALSE,
  covariates = c("width", "gc", "chromosome"),
  bgReplace = FALSE,
  seed = 1985,
  nrMethod = c("stratified", "rejection", "nearest"),
  bsGenome = NULL,
  promoterWindow = c(upstream = 300, downstream = 50),
  standardChroms = TRUE,
  reduceOverlaps = TRUE
)
}
\arguments{
\item{foreground_ids}{Character vector of user‐supplied gene or transcript IDs
(e.g. Ensembl, RefSeq, gene symbols) to analyze.}

\item{organism}{Character(1). Species name (e.g. \code{"Homo sapiens"}).}

\item{genomeBuild}{Character(1). UCSC genome build (e.g. \code{"hg38"}), or
\code{"auto"} to pick the latest supported build.}

\item{txdb}{Character(1). Name of a \pkg{TxDb} package (e.g.
\code{"TxDb.Hsapiens.UCSC.hg38.knownGene"}), or \code{"auto"}.}

\item{getEnsDb}{Logical; if \code{TRUE}, also load an \code{EnsDb} for
\code{TSS.method="Ensembl_canonical"}.}

\item{transcript}{Logical; \code{TRUE} to treat inputs as transcript‐level,
\code{FALSE} for gene‐level.}

\item{threshold}{Numeric in \link{0,1}. Min fraction of IDs that must map to
pick a keytype (default 0.9).}

\item{stripVersions}{Logical; strip “.1”, “.2” suffixes from Ensembl/RefSeq IDs.}

\item{inflateThresh}{Numeric in \link{0,1}; max allowed transcript:gene inflation
before auto‐collapsing (default 1).}

\item{geneType}{Optional character; biotype filter (e.g. \code{"protein-coding"}).}

\item{ensdb}{Optional \code{EnsDb} object; used only if \code{TSS.method="Ensembl_canonical"}.}

\item{TSS.method}{Character; TSS selection method for gene‐level mode:
\code{"UCSCgene"}, \code{"Ensembl_canonical"}, \code{"commonTSS"},
\code{"uniqueTSS"}, \code{"fivePrimeTSS"}, or \code{"allTSS"}.}

\item{overlapMinGap}{Numeric; minimum gap when reducing overlapping promoters.}

\item{onePromoterPerGene}{Logical; if \code{TRUE}, pick only one promoter per gene.}

\item{bgMethod}{Character; background sampling method: \code{"matched"},
\code{"pool"}, or \code{"random"}.}

\item{n_ratio}{Numeric; for \code{bgMethod="random"}, number of bg =
\code{n_ratio * #foreground}.}

\item{bgExcludeFgOverlaps}{Logical; drop any background overlapping a foreground.}

\item{bgExcludeFgGenes}{Logical; drop any background gene present in foreground.}

\item{covariates}{Character vector of covariate names for matching:
\code{"width"}, \code{"gc"}, \code{"chromosome"}, or any custom
\code{mcols()} column.}

\item{bgReplace}{Logical; allow replacement in sampling (random or matched).}

\item{seed}{Integer; random seed for reproducibility.}

\item{nrMethod}{Character; \code{"stratified"}, \code{"rejection"}, or
\code{"nearest"}—passed to matched sampling.}

\item{bsGenome}{Optional \pkg{BSgenome} object; required if \code{"gc"} is in
\code{covariates} and not otherwise provided.}

\item{promoterWindow}{Numeric named vector \code{c(upstream, downstream)};
promoter flank widths in bp (default \code{c(300,50)}).}

\item{standardChroms}{Logical; restrict to standard chromosomes.}

\item{reduceOverlaps}{Logical; merge overlapping promoter windows.}
}
\value{
A \code{list} containing the output of
\code{\link{getCoordinates}()}, namely:
\describe{
\item{backgroundElements}{\code{GRanges} of sampled background promoters}
\item{foregroundElements}{\code{GRanges} of foreground promoters}
\item{backgroundUniverse}{\code{GRanges} of the pruned promoter pool}
\item{matchObject}{\code{MatchedGRanges} if \code{bgMethod="matched"},
else \code{NULL}}
}
}
\description{
\code{enrichmentSets()} is a one‐stop wrapper that takes a vector of
user‐provided IDs from a differential expression analysis and returns
promoter regions plus matched background sets for downstream motif
enrichment.  It performs:
\enumerate{
\item ID mapping via \code{\link{buildMappingObject}()} and
\code{\link{mapIDs}()}.
\item Optional biotype filtering via \code{\link{poolFilter}()}.
\item Promoter coordinate extraction via \code{\link{getCoordinates}()}.
\item Background sampling (pool, random, or matched) within that same call.
}
}
\examples{
\dontrun{
# Minimal run with defaults:
results <- enrichmentSets(c("ENSG00000139618", "ENSG00000157764"))

# Full control:
results <- enrichmentSets(
  foreground_ids      = my_genes,
  organism            = "Homo sapiens",
  genomeBuild         = "hg38",
  transcript          = TRUE,
  geneType            = "protein-coding",
  TSS.method          = "commonTSS",
  bgMethod            = "matched",
  covariates          = c("gc","chromosome"),
  nrMethod            = "stratified",
  bsGenome            = BSgenome.Hsapiens.UCSC.hg38,
  promoterWindow      = c(upstream=500, downstream=100)
)
}

}
