% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/helper_defineBackgroundElements.R
\name{helper_defineBackgroundElements}
\alias{helper_defineBackgroundElements}
\title{Define and Sample Background Elements for Motif Enrichment}
\usage{
helper_defineBackgroundElements(
  background_universe,
  foreground_elements,
  bgMethod = c("pool", "random", "matched"),
  n_ratio = 1,
  bgExcludeFgOverlaps = TRUE,
  bgExcludeFgGenes = FALSE,
  covariates = c("width", "gc", "seqnames"),
  bgReplace = FALSE,
  seed = NULL,
  nrMethod = c("rejection", "nearest", "stratified"),
  bsGenome = NULL,
  organism,
  genomeBuild
)
}
\arguments{
\item{background_universe}{A \code{GRanges} of all candidate background regions (already pruned).}

\item{foreground_elements}{A \code{GRanges} of target regions for which backgrounds are needed.}

\item{bgMethod}{Character. One of \code{"pool"}, \code{"random"}, or \code{"matched"}.}

\item{n_ratio}{Numeric scalar. Number of background regions = \verb{n_ratio * number of foreground elements}.}

\item{bgExcludeFgOverlaps}{Logical. If \code{TRUE}, removes any background ranges overlapping foreground.}

\item{bgExcludeFgGenes}{Logical. If \code{TRUE}, removes any background whose gene (via \code{mcols()$entrez}) is in the foreground.}

\item{covariates}{Character vector. Covariates to match on for \code{matched} method. Valid entries:
\itemize{
\item \code{"width"} → injected as \code{promoterWidth}
\item \code{"seqnames"} or \code{"chromosome"} → injected as \code{chromosome}
\item \code{"gc"} → computed from \code{bsGenome}
\item any existing \code{mcols(background_universe)} column
}}

\item{bgReplace}{Logical. Allow replacement when sampling (applies to \code{random} and \code{matched}).}

\item{seed}{Integer. Optional random seed for reproducibility.}

\item{nrMethod}{Character. Sampling algorithm for \code{matched}: one of \code{"rejection"},\code{"nearest"},\code{"stratified"}.}

\item{bsGenome}{A loaded \code{BSgenome} object (e.g., \code{BSgenome.Hsapiens.UCSC.hg38}).
If \code{NULL} and \code{"gc"} is requested, the function will attempt to resolve one via \code{helper_resolveBSgenome()}.}

\item{organism}{Character(1). Species name (e.g., \code{"Homo sapiens"}), required if \code{bsGenome} must be resolved.}

\item{genomeBuild}{Character(1). UCSC build (e.g., \code{"hg38"}), required if resolving \code{bsGenome}.}
}
\value{
A named \code{list} with elements:
\itemize{
\item \code{backgroundElements}: \code{GRanges} of sampled background regions
\item \code{foregroundElements}: the input foreground \code{GRanges}
\item \code{backgroundUniverse}: the pruned universe \code{GRanges}
\item \code{matchObject}: a \code{MatchedGRanges} object if \code{bgMethod = "matched"}, else \code{NULL}
}
}
\description{
Filters and samples a set of background genomic ranges to match a given set
of foreground ranges based on user-specified covariates. Supports three methods:
\itemize{
\item \code{pool}: returns the pruned universe without sampling
\item \code{random}: draws a random sample of size \code{n_ratio * length(foreground_elements)}
\item \code{matched}: uses \code{nullranges::matchRanges()} to perform 1:1 matching on covariates
}
}
